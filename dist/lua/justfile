# Transpile source to lib/parable.lua
transpile source_file transpiler_dir:
    mkdir -p lib
    uv run --directory "{{transpiler_dir}}" python -m src.tongues --target lua < "{{source_file}}" > lib/parable.lua

# Syntax check
check-syntax:
    luac -p lib/parable.lua

# Run tests
check source_file transpiler_dir tests_dir:
    just transpile "{{source_file}}" "{{transpiler_dir}}"
    lua -e "package.path='lib/?.lua;'..package.path" bin/run_tests "{{tests_dir}}"
